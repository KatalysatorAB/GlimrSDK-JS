!function(e){"use strict";var r="//pixel.glimr.io",t="/v3/iptags/:id/",a=function(){},Glimr={useLocalStorage:!!e.localStorage,url:{host:r,tags:t},_currentCacheKey:null,JSONP:function(r,t){var a=(new Date).getTime(),n="glmrjsonp"+Math.round(a+1000001*Math.random()),i=document.createElement("script");e[n]=function(r){t(r);try{delete e[n]}catch(a){e[n]=void 0}try{i.parentNode.removeChild(i)}catch(a){}},r+=-1===r.indexOf("?")?"?":"&",r+="callback="+n,"function"==typeof i.addEventListener&&i.addEventListener("error",function(){t(!1)},!1),i.setAttribute("src",r),document.getElementsByTagName("head")[0].appendChild(i)},createCookie:function(e,r,t){var a=document.location.hostname.split("."),n=a.slice(a.length-2,a.length).join("."),i="";if(t){var o=new Date;o.setTime(o.getTime()+24*t*60*60*1e3),i="; expires="+o.toGMTString()}document.cookie=e+"="+r+i+"; path=/; domain="+n},readCookie:function(e){for(var r=e+"=",t=document.cookie.split(";"),a=0;a<t.length;a+=1){for(var n=t[a];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(r))return n.substring(r.length,n.length)}return null},generateUUID:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===r?t:3&t|8).toString(16)})},initGlimrId:function(){Glimr.glimrId=Glimr.readCookie("__glmrid"),Glimr.glimrId||(Glimr.glimrId=Glimr.generateUUID(),Glimr.setCookie())},setCookie:function(){Glimr.createCookie("__glmrid",Glimr.glimrId)},currentArticleCacheKey:function(){return Glimr._currentCacheKey?Glimr._currentCacheKey:a(document.location.pathname).substr(0,10)},getPixelLastUpdated:function(e){return Glimr.useLocalStorage?localStorage["glimrArticleTags_"+e+"_lastUpdate"]||!1:!1},getKeywordTags:function(e){var r=Glimr._getOrUnmarshalCache(e),t=this.currentArticleCacheKey();return r[t]||(r[t]=[]),r[t]},getTags:function(e,r){if(Glimr._loadingTags||(Glimr._loadingTags={}),Glimr._loadedTags||(Glimr._loadedTags={}),Glimr._loadedTags[e])return void r(Glimr._loadedTags[e]);if("undefined"!=typeof Glimr._loadingTags[e])return void Glimr._loadingTags[e].push(r);Glimr._loadingTags[e]=[],Glimr._loadingTags[e].push(r);try{Glimr.initGlimrId();var t=this.getPixelLastUpdated(e),a="";t&&(a+="&keywords_last_updated="+t),Glimr.JSONP((Glimr.url.host+Glimr.url.tags).replace(":id",e)+"?id="+Glimr.glimrId+a,function(r){var t=[];r&&r.tags&&(t=r.tags),r&&r.cache&&Glimr._updateCache(e,r.cache);for(var a=Glimr.getKeywordTags(e),n=0;n<a.length;n+=1)-1===t.indexOf(a[n])&&t.push(a[n]);Glimr._loadedTags[e]=t;var i=Glimr._loadingTags[e];delete Glimr._loadingTags[e];for(var o=0;o<i.length;o+=1)i[o](t);"string"==typeof r.id&&r.id!==Glimr.glimrId&&(Glimr.glimrId=r.id,Glimr.setCookie())})}catch(n){r([])}},_unmarshalTags:function(e){if(!e)return{};for(var r=e.split("|"),t={},a=0;a<r.length;a+=1){var n=r[a].indexOf("="),i=r[a].substring(0,n);t[i]=r[a].substring(n+1).split(",")}return t},_marshalTags:function(e){var r=[];for(var t in e)e.hasOwnProperty(t)&&r.push(t.substr(0,10)+"="+e[t].join(","));return r.join("|")},_updateCache:function(e,r){Glimr.useLocalStorage&&(localStorage["glimrArticleTags_"+e]=Glimr._marshalTags(r),localStorage["glimrArticleTags_"+e+"_lastUpdate"]=(new Date).getTime()),Glimr._articleCache||(Glimr._articleCache={}),Glimr._articleCache[e]||(Glimr._articleCache[e]={});for(var t in r)r.hasOwnProperty(t)&&(Glimr._articleCache[e][t.substr(0,10)]=r[t])},_getOrUnmarshalCache:function(e){return Glimr._articleCache||(Glimr._articleCache={}),Glimr.useLocalStorage&&localStorage["glimrArticleTags_"+e]&&(Glimr._articleCache[e]=Glimr._unmarshalTags(localStorage["glimrArticleTags_"+e])),Glimr._articleCache[e]||{}}};a=function(e){function r(e,r){return e<<r|e>>>32-r}function t(e,r){var t,a,n,i,o;return n=2147483648&e,i=2147483648&r,t=1073741824&e,a=1073741824&r,o=(1073741823&e)+(1073741823&r),t&a?2147483648^o^n^i:t|a?1073741824&o?3221225472^o^n^i:1073741824^o^n^i:o^n^i}function a(e,r,t){return e&r|~e&t}function n(e,r,t){return e&t|r&~t}function i(e,r,t){return e^r^t}function o(e,r,t){return r^(e|~t)}function c(e,n,i,o,c,l,g){return e=t(e,t(t(a(n,i,o),c),g)),t(r(e,l),n)}function l(e,a,i,o,c,l,g){return e=t(e,t(t(n(a,i,o),c),g)),t(r(e,l),a)}function g(e,a,n,o,c,l,g){return e=t(e,t(t(i(a,n,o),c),g)),t(r(e,l),a)}function u(e,a,n,i,c,l,g){return e=t(e,t(t(o(a,n,i),c),g)),t(r(e,l),a)}function s(e){for(var r,t=e.length,a=t+8,n=(a-a%64)/64,i=16*(n+1),o=Array(i-1),c=0,l=0;t>l;)r=(l-l%4)/4,c=l%4*8,o[r]=o[r]|e.charCodeAt(l)<<c,l+=1;return r=(l-l%4)/4,c=l%4*8,o[r]=o[r]|128<<c,o[i-2]=t<<3,o[i-1]=t>>>29,o}function d(e){var r,t,a="",n="";for(t=0;3>=t;t+=1)r=e>>>8*t&255,n="0"+r.toString(16),a+=n.substr(n.length-2,2);return a}function h(e){e=e.replace(/\r\n/g,"\n");for(var r="",t=0;t<e.length;t+=1){var a=e.charCodeAt(t);128>a?r+=String.fromCharCode(a):a>127&&2048>a?(r+=String.fromCharCode(a>>6|192),r+=String.fromCharCode(63&a|128)):(r+=String.fromCharCode(a>>12|224),r+=String.fromCharCode(a>>6&63|128),r+=String.fromCharCode(63&a|128))}return r}var f,m,_,C,x,p,v,T,S,y=[],w=7,A=12,k=17,I=22,b=5,O=9,U=14,L=20,K=4,D=11,P=16,M=23,j=6,E=10,G=15,N=21;for(e=h(e),y=s(e),p=1732584193,v=4023233417,T=2562383102,S=271733878,f=0;f<y.length;f+=16)m=p,_=v,C=T,x=S,p=c(p,v,T,S,y[f+0],w,3614090360),S=c(S,p,v,T,y[f+1],A,3905402710),T=c(T,S,p,v,y[f+2],k,606105819),v=c(v,T,S,p,y[f+3],I,3250441966),p=c(p,v,T,S,y[f+4],w,4118548399),S=c(S,p,v,T,y[f+5],A,1200080426),T=c(T,S,p,v,y[f+6],k,2821735955),v=c(v,T,S,p,y[f+7],I,4249261313),p=c(p,v,T,S,y[f+8],w,1770035416),S=c(S,p,v,T,y[f+9],A,2336552879),T=c(T,S,p,v,y[f+10],k,4294925233),v=c(v,T,S,p,y[f+11],I,2304563134),p=c(p,v,T,S,y[f+12],w,1804603682),S=c(S,p,v,T,y[f+13],A,4254626195),T=c(T,S,p,v,y[f+14],k,2792965006),v=c(v,T,S,p,y[f+15],I,1236535329),p=l(p,v,T,S,y[f+1],b,4129170786),S=l(S,p,v,T,y[f+6],O,3225465664),T=l(T,S,p,v,y[f+11],U,643717713),v=l(v,T,S,p,y[f+0],L,3921069994),p=l(p,v,T,S,y[f+5],b,3593408605),S=l(S,p,v,T,y[f+10],O,38016083),T=l(T,S,p,v,y[f+15],U,3634488961),v=l(v,T,S,p,y[f+4],L,3889429448),p=l(p,v,T,S,y[f+9],b,568446438),S=l(S,p,v,T,y[f+14],O,3275163606),T=l(T,S,p,v,y[f+3],U,4107603335),v=l(v,T,S,p,y[f+8],L,1163531501),p=l(p,v,T,S,y[f+13],b,2850285829),S=l(S,p,v,T,y[f+2],O,4243563512),T=l(T,S,p,v,y[f+7],U,1735328473),v=l(v,T,S,p,y[f+12],L,2368359562),p=g(p,v,T,S,y[f+5],K,4294588738),S=g(S,p,v,T,y[f+8],D,2272392833),T=g(T,S,p,v,y[f+11],P,1839030562),v=g(v,T,S,p,y[f+14],M,4259657740),p=g(p,v,T,S,y[f+1],K,2763975236),S=g(S,p,v,T,y[f+4],D,1272893353),T=g(T,S,p,v,y[f+7],P,4139469664),v=g(v,T,S,p,y[f+10],M,3200236656),p=g(p,v,T,S,y[f+13],K,681279174),S=g(S,p,v,T,y[f+0],D,3936430074),T=g(T,S,p,v,y[f+3],P,3572445317),v=g(v,T,S,p,y[f+6],M,76029189),p=g(p,v,T,S,y[f+9],K,3654602809),S=g(S,p,v,T,y[f+12],D,3873151461),T=g(T,S,p,v,y[f+15],P,530742520),v=g(v,T,S,p,y[f+2],M,3299628645),p=u(p,v,T,S,y[f+0],j,4096336452),S=u(S,p,v,T,y[f+7],E,1126891415),T=u(T,S,p,v,y[f+14],G,2878612391),v=u(v,T,S,p,y[f+5],N,4237533241),p=u(p,v,T,S,y[f+12],j,1700485571),S=u(S,p,v,T,y[f+3],E,2399980690),T=u(T,S,p,v,y[f+10],G,4293915773),v=u(v,T,S,p,y[f+1],N,2240044497),p=u(p,v,T,S,y[f+8],j,1873313359),S=u(S,p,v,T,y[f+15],E,4264355552),T=u(T,S,p,v,y[f+6],G,2734768916),v=u(v,T,S,p,y[f+13],N,1309151649),p=u(p,v,T,S,y[f+4],j,4149444226),S=u(S,p,v,T,y[f+11],E,3174756917),T=u(T,S,p,v,y[f+2],G,718787259),v=u(v,T,S,p,y[f+9],N,3951481745),p=t(p,m),v=t(v,_),T=t(T,C),S=t(S,x);var J=d(p)+d(v)+d(T)+d(S);return J.toLowerCase()},e.Glimr=Glimr}(window);
