!function(e){"use strict";var t="//pixel.glimr.io",r="/v3/iptags/:id/",a=function(){},Glimr={useLocalStorage:!!e.localStorage,url:{host:t,tags:r},_currentCacheKey:null,JSONP:function(t,r){var a=(new Date).getTime(),n="glmrjsonp"+Math.round(a+1000001*Math.random()),i=document.createElement("script");e[n]=function(t){r(t);try{delete e[n]}catch(a){e[n]=void 0}try{i.parentNode.removeChild(i)}catch(a){}},t+=-1===t.indexOf("?")?"?":"&",t+="callback="+n,"function"==typeof i.addEventListener&&i.addEventListener("error",function(){r(!1)},!1),i.setAttribute("src",t),document.getElementsByTagName("head")[0].appendChild(i)},createCookie:function(e,t,r){var a=document.location.hostname.split("."),n=a.slice(a.length-2,a.length).join("."),i="";if(r){var o=new Date;o.setTime(o.getTime()+24*r*60*60*1e3),i="; expires="+o.toGMTString()}document.cookie=e+"="+t+i+"; path=/; domain="+n},readCookie:function(e){for(var t=e+"=",r=document.cookie.split(";"),a=0;a<r.length;a+=1){for(var n=r[a];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(t))return n.substring(t.length,n.length)}return null},generateUUID:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)})},initGlimrId:function(){Glimr.glimrId=Glimr.readCookie("__glmrid"),Glimr.glimrId||(Glimr.glimrId=Glimr.generateUUID(),Glimr.setCookie())},setCookie:function(){Glimr.createCookie("__glmrid",Glimr.glimrId)},currentArticleCacheKey:function(){return Glimr._currentCacheKey?Glimr._currentCacheKey:a(document.location.pathname).substr(0,10)},getPixelLastUpdated:function(e){return Glimr.useLocalStorage?localStorage["glimrArticleTags_"+e+"_lastUpdate"]||!1:!1},getCachedTags:function(e){var t=Glimr._getOrUnmarshalCache(e),r=this.currentArticleCacheKey();return t[r]||(t[r]=[]),t[r]},getTags:function(e,t){if(Glimr._loadingTags||(Glimr._loadingTags={}),Glimr._loadedTags||(Glimr._loadedTags={}),Glimr._loadedTags[e])return void t(Glimr._loadedTags[e]);if("undefined"!=typeof Glimr._loadingTags[e])return void Glimr._loadingTags[e].push(t);Glimr._loadingTags[e]=[],Glimr._loadingTags[e].push(t);try{Glimr.initGlimrId();var r=this.getPixelLastUpdated(e),a="";r&&(a+="&keywords_last_updated="+r),Glimr.JSONP((Glimr.url.host+Glimr.url.tags).replace(":id",e)+"?id="+Glimr.glimrId+a,function(t){var r=[];t&&t.tags&&(r=t.tags),t&&t.cache&&Glimr._updateCache(e,t.cache);for(var a=Glimr.getCachedTags(e),n=0;n<a.length;n+=1)-1===r.indexOf(a[n])&&r.push(a[n]);Glimr._loadedTags[e]=r;var i=Glimr._loadingTags[e];delete Glimr._loadingTags[e];for(var o=0;o<i.length;o+=1)i[o](r);"string"==typeof t.id&&t.id!==Glimr.glimrId&&(Glimr.glimrId=t.id,Glimr.setCookie())})}catch(n){t([])}},getTagsAndPushToDataLayer:function(t,r){Glimr.getTags(t,function(t){e.dataLayer&&e.dataLayer.push&&e.dataLayer.push({glimrTags:t,event:"glimr.tags"}),r&&"function"==typeof r&&r()})},_unmarshalTags:function(e){if(!e)return{};for(var t=e.split("|"),r={},a=0;a<t.length;a+=1){var n=t[a].indexOf("="),i=t[a].substring(0,n);r[i]=t[a].substring(n+1).split(",")}return r},_marshalTags:function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r.substr(0,10)+"="+e[r].join(","));return t.join("|")},_updateCache:function(e,t){Glimr.useLocalStorage&&(localStorage["glimrArticleTags_"+e]=Glimr._marshalTags(t),localStorage["glimrArticleTags_"+e+"_lastUpdate"]=(new Date).getTime()),Glimr._articleCache||(Glimr._articleCache={}),Glimr._articleCache[e]||(Glimr._articleCache[e]={});for(var r in t)t.hasOwnProperty(r)&&(Glimr._articleCache[e][r.substr(0,10)]=t[r])},_getOrUnmarshalCache:function(e){return Glimr._articleCache||(Glimr._articleCache={}),Glimr.useLocalStorage&&localStorage["glimrArticleTags_"+e]&&(Glimr._articleCache[e]=Glimr._unmarshalTags(localStorage["glimrArticleTags_"+e])),Glimr._articleCache[e]||{}}};a=function(e){function t(e,t){return e<<t|e>>>32-t}function r(e,t){var r,a,n,i,o;return n=2147483648&e,i=2147483648&t,r=1073741824&e,a=1073741824&t,o=(1073741823&e)+(1073741823&t),r&a?2147483648^o^n^i:r|a?1073741824&o?3221225472^o^n^i:1073741824^o^n^i:o^n^i}function a(e,t,r){return e&t|~e&r}function n(e,t,r){return e&r|t&~r}function i(e,t,r){return e^t^r}function o(e,t,r){return t^(e|~r)}function c(e,n,i,o,c,l,g){return e=r(e,r(r(a(n,i,o),c),g)),r(t(e,l),n)}function l(e,a,i,o,c,l,g){return e=r(e,r(r(n(a,i,o),c),g)),r(t(e,l),a)}function g(e,a,n,o,c,l,g){return e=r(e,r(r(i(a,n,o),c),g)),r(t(e,l),a)}function u(e,a,n,i,c,l,g){return e=r(e,r(r(o(a,n,i),c),g)),r(t(e,l),a)}function s(e){for(var t,r=e.length,a=r+8,n=(a-a%64)/64,i=16*(n+1),o=Array(i-1),c=0,l=0;r>l;)t=(l-l%4)/4,c=l%4*8,o[t]=o[t]|e.charCodeAt(l)<<c,l+=1;return t=(l-l%4)/4,c=l%4*8,o[t]=o[t]|128<<c,o[i-2]=r<<3,o[i-1]=r>>>29,o}function d(e){var t,r,a="",n="";for(r=0;3>=r;r+=1)t=e>>>8*r&255,n="0"+t.toString(16),a+=n.substr(n.length-2,2);return a}function h(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r+=1){var a=e.charCodeAt(r);128>a?t+=String.fromCharCode(a):a>127&&2048>a?(t+=String.fromCharCode(a>>6|192),t+=String.fromCharCode(63&a|128)):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128),t+=String.fromCharCode(63&a|128))}return t}var f,m,_,C,x,p,T,v,y,S=[],A=7,L=12,k=17,I=22,b=5,w=9,O=14,U=20,D=4,P=11,K=16,M=23,j=6,E=10,G=15,N=21;for(e=h(e),S=s(e),p=1732584193,T=4023233417,v=2562383102,y=271733878,f=0;f<S.length;f+=16)m=p,_=T,C=v,x=y,p=c(p,T,v,y,S[f+0],A,3614090360),y=c(y,p,T,v,S[f+1],L,3905402710),v=c(v,y,p,T,S[f+2],k,606105819),T=c(T,v,y,p,S[f+3],I,3250441966),p=c(p,T,v,y,S[f+4],A,4118548399),y=c(y,p,T,v,S[f+5],L,1200080426),v=c(v,y,p,T,S[f+6],k,2821735955),T=c(T,v,y,p,S[f+7],I,4249261313),p=c(p,T,v,y,S[f+8],A,1770035416),y=c(y,p,T,v,S[f+9],L,2336552879),v=c(v,y,p,T,S[f+10],k,4294925233),T=c(T,v,y,p,S[f+11],I,2304563134),p=c(p,T,v,y,S[f+12],A,1804603682),y=c(y,p,T,v,S[f+13],L,4254626195),v=c(v,y,p,T,S[f+14],k,2792965006),T=c(T,v,y,p,S[f+15],I,1236535329),p=l(p,T,v,y,S[f+1],b,4129170786),y=l(y,p,T,v,S[f+6],w,3225465664),v=l(v,y,p,T,S[f+11],O,643717713),T=l(T,v,y,p,S[f+0],U,3921069994),p=l(p,T,v,y,S[f+5],b,3593408605),y=l(y,p,T,v,S[f+10],w,38016083),v=l(v,y,p,T,S[f+15],O,3634488961),T=l(T,v,y,p,S[f+4],U,3889429448),p=l(p,T,v,y,S[f+9],b,568446438),y=l(y,p,T,v,S[f+14],w,3275163606),v=l(v,y,p,T,S[f+3],O,4107603335),T=l(T,v,y,p,S[f+8],U,1163531501),p=l(p,T,v,y,S[f+13],b,2850285829),y=l(y,p,T,v,S[f+2],w,4243563512),v=l(v,y,p,T,S[f+7],O,1735328473),T=l(T,v,y,p,S[f+12],U,2368359562),p=g(p,T,v,y,S[f+5],D,4294588738),y=g(y,p,T,v,S[f+8],P,2272392833),v=g(v,y,p,T,S[f+11],K,1839030562),T=g(T,v,y,p,S[f+14],M,4259657740),p=g(p,T,v,y,S[f+1],D,2763975236),y=g(y,p,T,v,S[f+4],P,1272893353),v=g(v,y,p,T,S[f+7],K,4139469664),T=g(T,v,y,p,S[f+10],M,3200236656),p=g(p,T,v,y,S[f+13],D,681279174),y=g(y,p,T,v,S[f+0],P,3936430074),v=g(v,y,p,T,S[f+3],K,3572445317),T=g(T,v,y,p,S[f+6],M,76029189),p=g(p,T,v,y,S[f+9],D,3654602809),y=g(y,p,T,v,S[f+12],P,3873151461),v=g(v,y,p,T,S[f+15],K,530742520),T=g(T,v,y,p,S[f+2],M,3299628645),p=u(p,T,v,y,S[f+0],j,4096336452),y=u(y,p,T,v,S[f+7],E,1126891415),v=u(v,y,p,T,S[f+14],G,2878612391),T=u(T,v,y,p,S[f+5],N,4237533241),p=u(p,T,v,y,S[f+12],j,1700485571),y=u(y,p,T,v,S[f+3],E,2399980690),v=u(v,y,p,T,S[f+10],G,4293915773),T=u(T,v,y,p,S[f+1],N,2240044497),p=u(p,T,v,y,S[f+8],j,1873313359),y=u(y,p,T,v,S[f+15],E,4264355552),v=u(v,y,p,T,S[f+6],G,2734768916),T=u(T,v,y,p,S[f+13],N,1309151649),p=u(p,T,v,y,S[f+4],j,4149444226),y=u(y,p,T,v,S[f+11],E,3174756917),v=u(v,y,p,T,S[f+2],G,718787259),T=u(T,v,y,p,S[f+9],N,3951481745),p=r(p,m),T=r(T,_),v=r(v,C),y=r(y,x);var J=d(p)+d(T)+d(v)+d(y);return J.toLowerCase()},e.Glimr=Glimr}(window);
